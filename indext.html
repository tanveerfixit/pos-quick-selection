<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TechStore POS Pro</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        /* Hide scrollbar for Chrome, Safari and Opera */
        .no-scrollbar::-webkit-scrollbar { display: none; }
        /* Hide scrollbar for IE, Edge and Firefox */
        .no-scrollbar { -ms-overflow-style: none;  scrollbar-width: none; }
        
        /* Custom horizontal scroll styling */
        .scroll-container {
            display: flex;
            overflow-x: auto;
            gap: 0.5rem;
            padding-bottom: 4px;
            -webkit-overflow-scrolling: touch;
        }
    </style>
</head>

<body class="bg-slate-50 text-slate-900 min-h-screen">

    <!-- Header -->
    <header class="bg-white border-b border-slate-200 px-6 py-4 flex justify-between items-center sticky top-0 z-50">
        <div class="flex items-center gap-3">
            <div class="bg-blue-600 p-2 rounded-lg">
                <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z"></path></svg>
            </div>
            <h1 class="text-xl font-bold tracking-tight">TechStore <span class="text-blue-600">POS</span></h1>
        </div>
        <div id="currentTime" class="text-sm font-medium text-slate-500 hidden md:block"></div>
    </header>

    <!-- Main Container: Full width, no max-width box -->
    <main class="w-full grid grid-cols-1 lg:grid-cols-12 gap-6 p-4 md:p-6">
        
        <!-- LEFT: Selection & Search (Adjusted to 9 columns for wider workspace) -->
        <section class="lg:col-span-8 xl:col-span-9 space-y-6">
            
            <!-- Hierarchy Pickers -->
            <div class="bg-white rounded-2xl shadow-sm border border-slate-200 p-6 space-y-6">
                <div class="space-y-6">
                    <!-- Category Selection -->
                    <div class="space-y-2">
                        <div class="flex justify-between items-center">
                            <label class="text-xs font-bold uppercase tracking-wider text-slate-500">1. Category</label>
                            <select id="categorySelect" onchange="selectCategory(this.value)" class="text-xs bg-transparent border-none font-bold text-blue-600 focus:ring-0 cursor-pointer"></select>
                        </div>
                        <div id="categoryQuickButtons" class="scroll-container no-scrollbar"></div>
                    </div>

                    <!-- SubCategory Selection -->
                    <div class="space-y-2">
                        <div class="flex justify-between items-center">
                            <label class="text-xs font-bold uppercase tracking-wider text-slate-500">2. Sub-Category</label>
                            <select id="subCategorySelect" onchange="selectSubCategory(this.value)" class="text-xs bg-transparent border-none font-bold text-green-600 focus:ring-0 cursor-pointer disabled:opacity-0"></select>
                        </div>
                        <div id="subCategoryQuickButtons" class="scroll-container no-scrollbar"></div>
                    </div>

                    <!-- Type Selection -->
                    <div class="space-y-2">
                        <div class="flex justify-between items-center">
                            <label class="text-xs font-bold uppercase tracking-wider text-slate-500">3. Model / Product Type</label>
                            <select id="typeSelect" onchange="selectType(this.value)" class="text-xs bg-transparent border-none font-bold text-purple-600 focus:ring-0 cursor-pointer disabled:opacity-0"></select>
                        </div>
                        <div id="typeQuickButtons" class="scroll-container no-scrollbar"></div>
                    </div>
                </div>

                <!-- Product Search & Pricing -->
                <div class="pt-6 border-t border-slate-100 grid grid-cols-1 md:grid-cols-12 gap-4 items-end">
                    <div class="md:col-span-6 relative">
                        <label class="block text-xs font-bold uppercase tracking-wider text-slate-500 mb-2">Search Catalog</label>
                        <input id="productNameInput" type="text" placeholder="Start typing brand or model..." 
                            class="w-full bg-slate-50 border border-slate-200 rounded-xl p-3 focus:bg-white focus:ring-2 focus:ring-blue-500 outline-none transition-all" />
                        <div id="searchResults" class="absolute w-full bg-white border border-slate-200 rounded-xl mt-2 hidden shadow-2xl z-50 max-h-64 overflow-y-auto no-scrollbar"></div>
                    </div>

                    <div class="md:col-span-2">
                        <label class="block text-xs font-bold uppercase tracking-wider text-slate-500 mb-2">Price ($)</label>
                        <input id="priceInput" type="number" step="0.01" class="w-full bg-slate-50 border border-slate-200 rounded-xl p-3 focus:bg-white focus:ring-2 focus:ring-blue-500 outline-none" />
                    </div>

                    <div class="md:col-span-2">
                        <label class="block text-xs font-bold uppercase tracking-wider text-slate-500 mb-2">Qty</label>
                        <input id="qtyInput" type="number" min="1" value="1" class="w-full bg-slate-50 border border-slate-200 rounded-xl p-3 focus:bg-white focus:ring-2 focus:ring-blue-500 outline-none" />
                    </div>

                    <div class="md:col-span-2">
                        <button onclick="addProduct()" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-4 rounded-xl transition-all shadow-lg shadow-blue-200 flex items-center justify-center gap-2">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path></svg>
                            Add
                        </button>
                    </div>
                </div>
            </div>

            <!-- Status Message Toast Area -->
            <div id="statusMessage" class="hidden p-4 rounded-xl text-sm font-medium text-center"></div>
        </section>

        <!-- RIGHT: Cart / Invoice (Narrower 3-4 columns) -->
        <section class="lg:col-span-4 xl:col-span-3 flex flex-col h-[calc(100vh-140px)]">
            <div class="bg-white rounded-2xl shadow-sm border border-slate-200 flex flex-col h-full overflow-hidden">
                <div class="p-6 border-b border-slate-100 flex justify-between items-center">
                    <h2 class="font-bold text-lg flex items-center gap-2">
                        Order
                        <span id="cartBadge" class="bg-slate-100 text-slate-600 text-xs py-0.5 px-2 rounded-full">0</span>
                    </h2>
                    <button onclick="clearCart()" class="text-xs font-semibold text-slate-400 hover:text-red-500 transition-colors uppercase tracking-widest">Clear</button>
                </div>

                <!-- Cart Items Scroll Area -->
                <div id="cartItems" class="flex-1 overflow-y-auto p-4 space-y-4 no-scrollbar">
                    <!-- Empty State -->
                    <div id="emptyCartState" class="flex flex-col items-center justify-center h-full text-slate-400 space-y-2 opacity-60">
                        <svg class="w-10 h-10" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"></path></svg>
                        <p class="text-xs">No items in order</p>
                    </div>
                </div>

                <!-- Totals Section -->
                <div class="p-6 bg-slate-50 border-t border-slate-200 space-y-3">
                    <div class="flex justify-between text-xs text-slate-500 uppercase font-bold tracking-tight">
                        <span>Subtotal</span>
                        <span id="subtotalLabel">$0.00</span>
                    </div>
                    <div class="flex justify-between text-xs text-slate-500 uppercase font-bold tracking-tight">
                        <span>Tax (8%)</span>
                        <span id="taxLabel">$0.00</span>
                    </div>
                    <div class="flex justify-between text-lg font-extrabold text-slate-900 pt-2 border-t border-slate-200">
                        <span>Total</span>
                        <span id="totalLabel" class="text-blue-600">$0.00</span>
                    </div>
                    <button id="checkoutBtn" disabled class="w-full mt-4 bg-slate-900 disabled:bg-slate-300 text-white font-bold py-4 rounded-xl shadow-xl transition-all active:scale-95 uppercase tracking-widest text-xs">
                        Process Payment
                    </button>
                </div>
            </div>
        </section>
    </main>

    <script>
        // ----------------------
        // DATA LAYER
        // ----------------------
        const initialMockData = [
            { category: 'Phones', subCategories: [
                { name: 'iPhones', types: [ {name:'iPhone 13', brands:['Apple'], basePrice: 599}, {name:'iPhone 14', brands:['Apple'], basePrice: 699}, {name:'iPhone 15', brands:['Apple'], basePrice: 799}, {name:'iPhone 16', brands:['Apple'], basePrice: 899} ] },
                { name: 'Samsung', types: [ {name:'Galaxy A33', brands:['Samsung'], basePrice: 299}, {name:'Galaxy A34', brands:['Samsung'], basePrice: 349}, {name:'Galaxy S24', brands:['Samsung'], basePrice: 799} ] },
                { name: 'Redmi', types: [ {name:'Note 12', brands:['Xiaomi'], basePrice: 199}, {name:'Note 13 Pro', brands:['Xiaomi'], basePrice: 299} ] },
                { name: 'Pixels', types: [ {name:'Pixel 7', brands:['Google'], basePrice: 499}, {name:'Pixel 8 Pro', brands:['Google'], basePrice: 999} ] }
            ]},
            { category: 'Laptops', subCategories: [
                { name: 'Dell', types: [ {name:'XPS 13', brands:['Dell'], basePrice: 1099}, {name:'Inspiron', brands:['Dell'], basePrice: 649} ] },
                { name: 'Hp', types: [ {name:'Spectre x360', brands:['HP'], basePrice: 1249}, {name// ... rest of the same logic
                : 'Pavilion', brands:['HP'], basePrice: 599} ] },
                { name: 'ChromeBook', types: [ {name:'Pixelbook Go', brands:['Google'], basePrice: 649}, {name:'Acer Chromebook', brands:['Acer'], basePrice: 299} ] },
                { name: 'Lenovo', types: [ {name:'ThinkPad X1', brands:['Lenovo'], basePrice: 1399}, {name:'Yoga 7i', brands:['Lenovo'], basePrice: 849} ] }
            ]},
            { category: 'Tablets', subCategories: [
                { name: 'iPad', types: [ {name:'iPad Air', brands:['Apple'], basePrice: 599}, {name:'iPad Pro', brands:['Apple'], basePrice: 799} ] },
                { name: 'Galaxy', types: [ {name:'Tab S9', brands:['Samsung'], basePrice: 699}, {name:'Tab A8', brands:['Samsung'], basePrice: 229} ] },
                { name: 'Android', types: [ {name:'Pixel Tablet', brands:['Google'], basePrice: 499}, {name:'Lenovo Tab', brands:['Lenovo'], basePrice: 179} ] }
            ]},
            { category: 'Audio', subCategories: [
                { name: 'BT Speakers', types: [ {name:'Flip 6', brands:['JBL'], basePrice: 129}, {name:'SoundLink', brands:['Bose'], basePrice: 149} ] },
                { name: 'Wired Headphones', types: [ {name:'MDR-7506', brands:['Sony'], basePrice: 99} ] },
                { name: 'Bluetooth Headphones', types: [ {name:'WH-1000XM5', brands:['Sony'], basePrice: 399}, {name:'QC45', brands:['Bose'], basePrice: 329} ] },
                { name: 'True Wireless Earbuds (TWS)', types: [ {name:'WF-1000XM5', brands:['Sony'], basePrice: 299}, {name:'Buds 2 Pro', brands:['Samsung'], basePrice: 199} ] },
                { name: 'AirPods', types: [ {name:'AirPods Pro 2', brands:['Apple'], basePrice: 249}, {name:'AirPods 3', brands:['Apple'], basePrice: 169} ] },
                { name: 'EarPods', types: [ {name:'EarPods USB-C', brands:['Apple'], basePrice: 19} ] }
            ]},
            { category: 'Accessories', subCategories: [
                { name: 'Cases', types: [ {name:'Silicone Case', brands:['Generic'], basePrice: 15} ] },
                { name: 'Plugs/Charger', types: [ {name:'20W Adapter', brands:['Apple'], basePrice: 19} ] },
                { name: 'Cables', types: [ {name:'USB-C to C', brands:['Anker'], basePrice: 12} ] },
                { name: 'Screen Protection', types: [ {name:'Tempered Glass', brands:['Generic'], basePrice: 10} ] },
                { name: 'Phone Holder', types: [ {name:'MagSafe Mount', brands:['Belkin'], basePrice: 29} ] },
                { name: 'Adapter', types: [ {name:'USB-C Hub', brands:['Satechi'], basePrice: 59} ] },
                { name: 'Power Bank', types: [ {name:'20k mAh Bank', brands:['Anker'], basePrice: 49} ] },
                { name: 'Selfi Stick', types: [ {name:'Tripod Stick', brands:['Generic'], basePrice: 25} ] },
                { name: 'Gaming Controller', types: [ {name:'DualSense', brands:['Sony'], basePrice: 69}, {name:'Xbox Controller', brands:['MS'], basePrice: 59} ] }
            ]},
            { category: 'Services', subCategories: [
                { name: 'Repair', types: [ {name:'Screen Repair', brands:['Service'], basePrice: 149}, {name:'Battery Swap', brands:['Service'], basePrice: 79} ] },
                { name: 'Warranty', types: [ {name:'Extended 1yr', brands:['Care'], basePrice: 99} ] }
            ]}
        ];

        let productList = [];
        let cart = [];
        let uiState = {
            selectedCategory: null,
            selectedSubCategory: null,
            selectedType: null,
            currentProduct: null
        };

        const els = {
            categorySelect: document.getElementById('categorySelect'),
            subCategorySelect: document.getElementById('subCategorySelect'),
            typeSelect: document.getElementById('typeSelect'),
            catBtns: document.getElementById('categoryQuickButtons'),
            subBtns: document.getElementById('subCategoryQuickButtons'),
            typeBtns: document.getElementById('typeQuickButtons'),
            nameInput: document.getElementById('productNameInput'),
            priceInput: document.getElementById('priceInput'),
            qtyInput: document.getElementById('qtyInput'),
            results: document.getElementById('searchResults'),
            cartItems: document.getElementById('cartItems'),
            subtotal: document.getElementById('subtotalLabel'),
            tax: document.getElementById('taxLabel'),
            total: document.getElementById('totalLabel'),
            cartBadge: document.getElementById('cartBadge'),
            checkoutBtn: document.getElementById('checkoutBtn'),
            status: document.getElementById('statusMessage'),
            empty: document.getElementById('emptyCartState')
        };

        function init() {
            flattenData();
            renderPickers();
            updateTime();
            setInterval(updateTime, 1000);
            document.addEventListener('keypress', (e) => { if(e.key === 'Enter') addProduct(); });
        }

        function flattenData() {
            productList = [];
            initialMockData.forEach(cat => {
                cat.subCategories.forEach(sub => {
                    sub.types.forEach(t => {
                        t.brands.forEach(b => {
                            productList.push({
                                id: Math.random().toString(36).substr(2, 9),
                                name: `${b} ${t.name}`,
                                brand: b,
                                type: t.name,
                                category: cat.category,
                                subCategory: sub.name,
                                price: t.basePrice || 0
                            });
                        });
                    });
                });
            });
        }

        function renderPickers() {
            els.categorySelect.innerHTML = `<option value="">Select Category</option>` + 
                initialMockData.map(c => `<option value="${c.category}">${c.category}</option>`).join('');
            renderQuickButtons();
            updateDependentPickers();
        }

        function updateDependentPickers() {
            const catData = initialMockData.find(c => c.category === uiState.selectedCategory);
            els.subCategorySelect.disabled = !catData;
            els.subCategorySelect.innerHTML = `<option value="">Select Sub</option>` + 
                (catData ? catData.subCategories.map(s => `<option value="${s.name}">${s.name}</option>`).join('') : '');
            const subData = catData?.subCategories.find(s => s.name === uiState.selectedSubCategory);
            els.typeSelect.disabled = !subData;
            els.typeSelect.innerHTML = `<option value="">Select Type</option>` + 
                (subData ? subData.types.map(t => `<option value="${t.name}">${t.name}</option>`).join('') : '');
            els.categorySelect.value = uiState.selectedCategory || '';
            els.subCategorySelect.value = uiState.selectedSubCategory || '';
            els.typeSelect.value = uiState.selectedType || '';
            renderQuickButtons();
        }

        function renderQuickButtons() {
            els.catBtns.innerHTML = initialMockData.map(c => {
                const isActive = uiState.selectedCategory === c.category;
                return `<button onclick="selectCategory('${c.category}')" class="flex-shrink-0 px-4 py-2 text-xs font-bold uppercase rounded-xl border transition-all whitespace-nowrap ${isActive ? 'bg-blue-600 border-blue-600 text-white shadow-md' : 'border-slate-200 text-slate-600 hover:bg-blue-50 hover:border-blue-200'}">${c.category}</button>`;
            }).join('');
            const catData = initialMockData.find(c => c.category === uiState.selectedCategory);
            els.subBtns.innerHTML = catData ? catData.subCategories.map(s => {
                const isActive = uiState.selectedSubCategory === s.name;
                return `<button onclick="selectSubCategory('${s.name}')" class="flex-shrink-0 px-4 py-2 text-xs font-bold uppercase rounded-xl border transition-all whitespace-nowrap ${isActive ? 'bg-green-600 border-green-600 text-white shadow-md' : 'border-slate-200 text-slate-600 hover:bg-green-50 hover:border-green-200'}">${s.name}</button>`;
            }).join('') : `<div class="text-xs text-slate-300 py-2 italic">Select a category first</div>`;
            const subData = catData?.subCategories.find(s => s.name === uiState.selectedSubCategory);
            els.typeBtns.innerHTML = subData ? subData.types.map(t => {
                const isActive = uiState.selectedType === t.name;
                return `<button onclick="selectType('${t.name}')" class="flex-shrink-0 px-4 py-2 text-xs font-bold uppercase rounded-xl border transition-all whitespace-nowrap ${isActive ? 'bg-purple-600 border-purple-600 text-white shadow-md' : 'border-slate-200 text-slate-600 hover:bg-purple-50 hover:border-purple-200'}">${t.name}</button>`;
            }).join('') : `<div class="text-xs text-slate-300 py-2 italic">Select a sub-category first</div>`;
        }

        window.selectCategory = (cat) => { uiState.selectedCategory = cat; uiState.selectedSubCategory = null; uiState.selectedType = null; updateDependentPickers(); autoFillProduct(); };
        window.selectSubCategory = (sub) => { uiState.selectedSubCategory = sub; uiState.selectedType = null; updateDependentPickers(); autoFillProduct(); };
        window.selectType = (type) => { uiState.selectedType = type; updateDependentPickers(); autoFillProduct(); };

        function autoFillProduct() {
            const match = productList.find(p => p.category === uiState.selectedCategory && p.subCategory === uiState.selectedSubCategory && p.type === uiState.selectedType);
            if(match) populateForm(match);
        }

        function populateForm(product) {
            uiState.currentProduct = product;
            els.nameInput.value = product.name;
            els.priceInput.value = product.price;
            els.qtyInput.value = 1;
            els.results.classList.add('hidden');
        }

        els.nameInput.addEventListener('input', (e) => {
            const q = e.target.value.toLowerCase().trim();
            if(!q) { els.results.classList.add('hidden'); return; }
            const hits = productList.filter(p => p.name.toLowerCase().includes(q));
            els.results.innerHTML = hits.map(p => `
                <div class="p-3 hover:bg-blue-50 cursor-pointer border-b border-slate-50 last:border-0" onclick='handleSearchSelect(${JSON.stringify(p)})'>
                    <div class="font-bold text-sm text-slate-800">${p.name}</div>
                    <div class="text-[10px] text-slate-400 uppercase font-bold">${p.category} • ${p.subCategory}</div>
                </div>
            `).join('');
            els.results.classList.remove('hidden');
        });

        window.handleSearchSelect = (p) => { populateForm(p); uiState.selectedCategory = p.category; uiState.selectedSubCategory = p.subCategory; uiState.selectedType = p.type; updateDependentPickers(); };

        window.addProduct = () => {
            const name = els.nameInput.value;
            const price = parseFloat(els.priceInput.value);
            const qty = parseInt(els.qtyInput.value);
            if(!name || isNaN(price) || isNaN(qty) || qty < 1) { showStatus('Missing product info', 'error'); return; }
            cart.push({ cartId: Date.now(), name, price, qty, total: price * qty });
            renderCart();
            showStatus(`Added ${name}`, 'success');
            els.nameInput.value = '';
            els.qtyInput.value = 1;
        };

        window.removeFromCart = (cartId) => { cart = cart.filter(item => item.cartId !== cartId); renderCart(); };
        window.clearCart = () => { cart = []; renderCart(); };

        function renderCart() {
            els.cartBadge.textContent = cart.length;
            els.checkoutBtn.disabled = cart.length === 0;
            els.empty.style.display = cart.length === 0 ? 'flex' : 'none';
            els.cartItems.innerHTML = cart.map(item => `
                <div class="bg-white border border-slate-100 p-3 rounded-xl shadow-sm flex justify-between items-center animate-in fade-in slide-in-from-right-4 duration-200">
                    <div class="max-w-[150px]">
                        <div class="font-bold text-[13px] text-slate-800 truncate">${item.name}</div>
                        <div class="text-[10px] text-slate-400 font-medium">${item.qty} × $${item.price.toFixed(2)}</div>
                    </div>
                    <div class="flex items-center gap-2">
                        <div class="font-bold text-blue-600 text-xs">$${item.total.toFixed(2)}</div>
                        <button onclick="removeFromCart(${item.cartId})" class="p-1.5 text-slate-300 hover:text-red-500 transition-all">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg>
                        </button>
                    </div>
                </div>
            `).join('');
            const sub = cart.reduce((acc, i) => acc + i.total, 0);
            const tax = sub * 0.08;
            const total = sub + tax;
            els.subtotal.textContent = `$${sub.toFixed(2)}`;
            els.tax.textContent = `$${tax.toFixed(2)}`;
            els.total.textContent = `$${total.toFixed(2)}`;
        }

        function showStatus(msg, type) {
            els.status.textContent = msg;
            els.status.className = `p-4 rounded-xl text-sm font-bold text-center fixed bottom-6 left-6 z-[100] shadow-2xl animate-bounce ${type === 'success' ? 'bg-green-600 text-white' : 'bg-red-600 text-white'}`;
            els.status.classList.remove('hidden');
            setTimeout(() => els.status.classList.add('hidden'), 3000);
        }

        function updateTime() {
            const now = new Date();
            document.getElementById('currentTime').textContent = now.toLocaleString('en-US', { weekday: 'short', month: 'short', day: 'numeric', hour: '2-digit', minute: '2-digit', second: '2-digit' });
        }

        init();
    </script>
</body>
</html>
